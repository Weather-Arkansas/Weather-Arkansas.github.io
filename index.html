<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weather Arkansas</title>
<style>
/* Global */
body, html {
    margin:0; padding:0;
    width:100%; height:100%;
    font-family:"Lato", sans-serif;
    overflow-x:hidden;
}

/* Background & Clouds */
.background { position:absolute; width:100%; height:100%; z-index:1; overflow:hidden; }
.cloud {
    position:absolute; background:#fff; border-radius:50%;
    width:200px; height:60px; animation: moveClouds 25s linear infinite;
}
.cloud::before, .cloud::after { content:""; position:absolute; background:#fff; border-radius:50%; }
.cloud::before { width:100px; height:100px; top:-50px; left:50px; }
.cloud::after { width:120px; height:120px; top:-60px; left:100px; }
.sun {
    position:absolute; width:100px; height:100px;
    top:10%; left:10%;
    background: radial-gradient(circle,#FFD700,#FFA500);
    border-radius:50%;
    box-shadow:0 0 50px rgba(255,215,0,0.5);
}
@keyframes moveClouds { 0% {transform:translateX(-100%);} 100% {transform:translateX(100%);} }

/* Top bar */
.topbar {
    width:100%; background:teal; color:white;
    padding:12px; font-size:20px; text-align:center;
    position:sticky; top:0; z-index:5;
}

/* Sidebar Navigation */
.sidenav {
    height:100%; width:0; position:fixed; z-index:10; top:0; left:0;
    background:#111; overflow-x:hidden; transition:0.5s; padding-top:60px; text-align:center;
}
.sidenav a {
    padding:8px 8px 8px 32px;
    text-decoration:none; font-size:25px;
    color:#818181; display:block; transition:0.3s;
}
.sidenav a:hover{ color:white; }
.sidenav .closebtn { position:absolute; top:0; right:25px; font-size:36px; cursor:pointer; }
.menu { font-size:30px; cursor:pointer; position:absolute; top:12px; left:12px; color:teal; z-index:6; }

/* Landing Page */
#landing {
    position:absolute; width:100%; height:100%;
    display:flex; flex-direction:column;
    justify-content:center; align-items:center;
    background:linear-gradient(to bottom,#87CEEB,#fff);
    text-align:center; z-index:9;
}
#landing h1 { font-size:3em; margin-bottom:20px; color:teal; text-shadow:1px 1px 2px #000; }
#landing p { font-size:1.2em; margin-bottom:40px; color:#333; }
#landing button {
    padding:12px 30px; font-size:1.2em;
    border:none; border-radius:8px;
    background:teal; color:white; cursor:pointer;
}
#landing button:hover { background:#006666; }

/* Main Content */
#mainContent { display:none; position:relative; z-index:2; padding:20px; max-width:900px; margin:80px auto; background:white; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.2); }
h2 { text-align:center; }
.station-data { margin-top:20px; padding:10px; border:1px solid #ccc; border-radius:8px; background:#f0f8ff; }
.station-warning { color:red; font-style:italic; margin-top:10px; }

/* Tabs for stations */
.tabs { display:flex; margin-bottom:10px; }
.tab { flex:1; padding:10px; text-align:center; cursor:pointer; background:#eee; border-radius:6px 6px 0 0; border:1px solid #ccc; border-bottom:none; margin-right:2px; }
.tab.active { background: teal; color:white; }
.tab-content { border:1px solid #ccc; border-radius:0 0 6px 6px; padding:15px; display:none; }
</style>
</head>
<body>

<div class="background">
    <div class="sun"></div>
    <div class="cloud" style="top:20%; animation-duration:20s;"></div>
    <div class="cloud" style="top:50%; animation-duration:28s;"></div>
    <div class="cloud" style="top:70%; animation-duration:24s;"></div>
</div>

<!-- Landing Page -->
<div id="landing">
    <h1>Welcome to Weather Arkansas</h1>
    <p>Your go-to source for live weather updates in Arkansas.</p>
    <button id="enterBtn">Enter Site</button>
</div>

<!-- Main Page -->
<div id="mainContent">
    <div class="topbar">Weather Arkansas</div>
    <div id="mySidenav" class="sidenav">
        <span class="closebtn" onclick="closeNav()">×</span>
        <a href="/index.html">Home</a>
        <a href="/weather/10day.html">10-Day Forecast</a>
        <a href="/weather/stations.html">Weather Stations</a>
        <a href="/about.html">About</a>
        <a href="/settings.html">Settings</a>
    </div>
    <span class="menu" onclick="openNav()">☰</span>

    <div style="padding:20px;">
        <h2>10-Day Forecast</h2>
        <div id="forecast">Loading forecast...</div>

        <h2>Connect Weather Stations</h2>
        <div class="tabs">
            <div class="tab active" onclick="showTab('wunderground')">WUnderground</div>
            <div class="tab" onclick="showTab('other')">Other</div>
        </div>
        <div class="tab-content" id="wunderground">
            <label>Station ID</label>
            <input type="text" id="stationId" placeholder="KARMALVE22">
            <label>API Key</label>
            <input type="text" id="apiKey" placeholder="Your WUnderground API Key">
            <button onclick="saveStation()">Save & Load</button>
            <div class="station-data" id="stationData">No station loaded yet.</div>
        </div>
        <div class="tab-content" id="other">
            <p>Other station integrations coming soon...</p>
        </div>
    </div>
</div>

<script>
// Cloud randomization
document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('.cloud').forEach(c => {
        c.style.left = Math.random()*100 + "%";
        c.style.animationDuration = (18 + Math.random()*12) + "s";
    });
});

// Sidebar nav
function openNav(){ document.getElementById("mySidenav").style.width="100%"; }
function closeNav(){ document.getElementById("mySidenav").style.width="0"; }

// Tabs
function showTab(tab){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c=>c.style.display='none');
    document.querySelector(`[onclick="showTab('${tab}')"]`).classList.add('active');
    document.getElementById(tab).style.display='block';
}
showTab('wunderground'); // default

// Landing page logic
const signedIn = localStorage.getItem("signedIn") === "true";
const lastVisit = localStorage.getItem("lastVisit");
const now = new Date().getTime();
const sessionTimeout = 7*24*60*60*1000; // 7 days

if(signedIn && lastVisit && (now - lastVisit) < sessionTimeout){
    document.getElementById("landing").style.display = "none";
    document.getElementById("mainContent").style.display = "block";
} else {
    document.getElementById("landing").style.display = "flex";
    document.getElementById("mainContent").style.display = "none";
}

document.getElementById("enterBtn").addEventListener("click", ()=>{
    localStorage.setItem("signedIn","true");
    localStorage.setItem("lastVisit", new Date().getTime());
    document.getElementById("landing").style.display = "none";
    document.getElementById("mainContent").style.display = "block";
});

// Weather station logic
function saveStation(){
    const stationId = document.getElementById("stationId").value.trim();
    const apiKey = document.getElementById("apiKey").value.trim();
    if(!stationId || !apiKey){ alert("Enter Station ID & API Key"); return; }
    localStorage.setItem("stationId", stationId);
    localStorage.setItem("apiKey", apiKey);
    loadStation(stationId, apiKey);
}

async function loadStation(stationId, apiKey){
    const display = document.getElementById("stationData");
    display.innerHTML = "<p>Loading data...</p>";
    try{
        const url = `https://api.weather.com/v2/pws/observations/current?stationId=${stationId}&format=json&units=e&apiKey=${apiKey}`;
        const response = await fetch(url);
        if(!response.ok) throw new Error("Failed fetch");
        const data = await response.json();
        const obs = data.observations[0];
        display.innerHTML = `
            <h3>${stationId} - ${obs.obsTimeLocal}</h3>
            <p>Temperature: ${obs.imperial.temp} °F</p>
            <p>Humidity: ${obs.humidity} %</p>
            <p>Wind: ${obs.imperial.windSpeed} mph</p>
            <p>Pressure: ${obs.imperial.pressure} inHg</p>
            <p>Rain Today: ${obs.imperial.precipTotal} in</p>
        `;
    } catch(e){
        display.innerHTML = `<p class="station-warning">Could not load station. Check Station ID & API Key.</p>`;
    }
}

// Load saved station if exists
if(localStorage.getItem("stationId") && localStorage.getItem("apiKey")){
    document.getElementById("stationId").value = localStorage.getItem("stationId");
    document.getElementById("apiKey").value = localStorage.getItem("apiKey");
    loadStation(localStorage.getItem("stationId"), localStorage.getItem("apiKey"));
}

// Forecast placeholder
document.getElementById("forecast").innerHTML = "<p>10-Day Forecast will appear here...</p>";

</script>

</body>
</html>
