<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weather Arkansas</title>
<style>
body, html {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    overflow-x: hidden;
    font-family: "Lato", sans-serif;
    color: teal;
    background: #87CEEB;
    transition: background 1s;
}
.background { position: absolute; width:100%; height:100%; z-index:1; overflow:hidden; }
.cloud {
    position: absolute;
    background: #fff;
    border-radius: 50%;
    width:200px; height:60px;
    animation: moveClouds 20s linear infinite;
    z-index:2;
}
.cloud::before, .cloud::after { content:''; position:absolute; background:#fff; border-radius:50%; }
.cloud::before { width:100px; height:100px; top:-50px; left:50px; }
.cloud::after { width:120px; height:120px; top:-60px; left:100px; }

.sun {
    position: absolute; width:100px; height:100px;
    top:10%; left:10%; border-radius:50%;
    background: radial-gradient(circle, #FFD700, #FFA500);
    z-index:1; box-shadow:0 0 50px rgba(255,215,0,0.5);
}
.sun::before {
    content: '';
    position: absolute;
    width: 150px; height: 150px;
    top:-25px; left:-25px;
    background: radial-gradient(circle, rgba(255,215,0,0.5), rgba(255,165,0,0));
    border-radius:50%; z-index:-1;
}

.rain { position:absolute; width:100%; height:100%; top:0; left:0; z-index:1; display:none; opacity:0; transition: opacity 1s; pointer-events:none;}
.raindrop { position:absolute; width:2px; height:10px; background:rgba(0,0,255,0.5); animation: fall 1s linear infinite; }

@keyframes moveClouds { 0% { transform:translateX(-100%);} 100% { transform:translateX(100%);} }
@keyframes fall { 0% {top:-10px;} 100% {top:100%;} }

.content { position:relative; z-index:2; text-align:center; padding:20px; transition: color 1s, text-shadow 1s; }
.content.rainy { text-shadow: 2px 2px 4px #000; }

h1 { font-size:2.5em; margin:0; }
p { font-size:0.9em; }

.sidenav { height:100%; width:0; position:fixed; z-index:3; top:0; left:0; background:#111; overflow-x:hidden; transition:0.5s; padding-top:60px; text-align:center;}
.sidenav a { padding:8px 8px 8px 32px; text-decoration:none; font-size:25px; color:#818181; display:block; transition:0.3s; }
.sidenav a:hover{ color:#f1f1f1; }
.sidenav .closebtn { position:absolute; top:0; right:25px; font-size:36px; margin-left:50px; }
@media screen and (max-height:450px){.sidenav{padding-top:15px;} .sidenav a{font-size:18px;}}
#signOutBtn {
    position: absolute; top:12px; right:12px; padding:6px 12px;
    border:none; border-radius:6px; background:teal; color:white; cursor:pointer;
}
#signOutBtn:hover { background:#006666; }
</style>
</head>
<body>

<!-- Require sign-in -->
<script>
const signedIn = localStorage.getItem("signedIn") === "true";
if(!signedIn){
    window.location.href = "/signin.html"; // redirect to sign-in page
}
</script>

<div class="background">
    <div class="sun" style="display: block;"></div>
    <div class="cloud" style="top: 90%; left: 50%; animation-duration: 21s;"></div>
    <div class="cloud" style="top: 50%; left: 8%; animation-duration: 26s;"></div>
    <div class="cloud" style="top: 25%; left: 23%; animation-duration: 20s;"></div>
    <div class="rain"></div>
</div>

<div class="content" style="color: rgb(0, 0, 0);">
    <!-- Side navigation -->
    <div id="mySidenav" class="sidenav">
      <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
      
      <!-- Main pages -->
      <a href="/index.html">Home</a>
      
      <!-- Weather pages -->
      <a href="/weather/10day.html">10-Day Forecast</a>
      <a href="/weather/station.html">Weather Stations</a>
      <a href="/weather/Little-Rock.html">Capitol Weather</a>
      <a href="/weather/radar.html">Local Radar</a>
      
      <!-- Other pages -->
      <a href="/about.html">About</a>
      <a href="/settings.html">Settings</a>
      
      <!-- Sign In / Out -->
      <a href="/signin.html" id="signInLink">Sign In</a>
    </div>
    <span style="font-size:30px;cursor:pointer" onclick="openNav()">☰</span>

    <button id="signOutBtn">Sign Out</button>

    <h1>Welcome to Weather Arkansas</h1>
    <p>Your go-to source for weather updates in Arkansas!</p>
    <hr>
    <div class="additional-content">
        <p>Arkansas experiences a wide range of weather conditions, from hot summers to cold winters. Stay updated with our latest weather forecasts!</p>
    </div>

    <!-- Weekly Forecast -->
    <h1 align="center">What's Happening in Weather This Week</h1>
    <div id="weekly-forecast" align="center"><p>Loading forecast...</p></div>

    <!-- NOAA Precipitation Map -->
    <h2>Precipitation Forecast</h2>
    <img src="https://www.wpc.ncep.noaa.gov/qpf/94ewbg.gif" alt="Precipitation Forecast" style="width:90%; max-width:800px;">

    <!-- Windy.io Interactive Map -->
    <h2>Interactive Weather Map</h2>
    <iframe src="https://embed.windy.com/embed2.html?lat=34.7465&amp;lon=-92.2896&amp;zoom=6&amp;level=surface&amp;overlay=radar&amp;product=radar&amp;menu=&amp;message=&amp;marker=&amp;calendar=now&amp;pressure=&amp;type=map&amp;location=coordinates&amp;detail=true&amp;detailLat=34.7465&amp;detailLon=-92.2896" width="90%" height="500" frameborder="0"></iframe>

    <!-- Home Weather Station Placeholder -->
    <h2>My Home Weather Station</h2>
    <div id="home-station">
        <p>Link your weather station widget here!</p>
    </div>

</div>

<script>
// Side nav
function openNav(){ document.getElementById("mySidenav").style.width="100%";}
function closeNav(){ document.getElementById("mySidenav").style.width="0";}

// Sign out button
document.getElementById("signOutBtn").addEventListener("click", ()=>{
    localStorage.removeItem("signedIn");
    localStorage.removeItem("lastVisit");
    alert("You have been signed out.");
    window.location.href="/signin.html";
});

// Dynamic Sign In / Sign Out in menu
const signInLink = document.getElementById("signInLink");
if(signedIn){
    signInLink.textContent = "Sign Out";
    signInLink.href = "#";
    signInLink.addEventListener("click", ()=>{
        localStorage.removeItem("signedIn");
        localStorage.removeItem("lastVisit");
        alert("You have been signed out.");
        window.location.href="/signin.html";
    });
} else {
    signInLink.textContent = "Sign In";
    signInLink.href = "/signin.html";
}

// Weekly Forecast
async function fetchWeeklyForecast() {
    try {
        const response = await fetch('https://api.weather.gov/gridpoints/LZK/36,91/forecast');
        const data = await response.json();
        const forecastDiv = document.getElementById('weekly-forecast');
        let html = '';
        data.properties.periods.slice(0,7).forEach(period => {
            html += `<p><strong>${period.name}:</strong> ${period.detailedForecast}</p>`;
        });
        forecastDiv.innerHTML = html;
    } catch (err) {
        console.error(err);
        document.getElementById('weekly-forecast').innerHTML='<p>Unable to load forecast.</p>';
    }
}
fetchWeeklyForecast();
setInterval(fetchWeeklyForecast, 21600000); // refresh every 6 hrs

// Clouds & Rain Animation
document.addEventListener('DOMContentLoaded', () => {
    const clouds=document.querySelectorAll('.cloud');
    clouds.forEach(c=>{ 
        c.style.top=`${Math.random()*100}%`; 
        c.style.left=`${Math.random()*100}%`; 
        c.style.animationDuration=`${10+Math.random()*20}s`; 
    });

    const rainContainer=document.querySelector('.rain');
    const sun=document.querySelector('.sun');
    const content=document.querySelector('.content');

    function startRain(){
        rainContainer.style.display='block';
        rainContainer.style.opacity=1;
        document.body.style.background='#2F4F4F';
        content.style.color='#fff';
        content.classList.add('rainy');
        sun.style.display='none';
        clouds.forEach(c=>c.style.background='#A9A9A9');
        for(let i=0;i<100;i++){
            const drop=document.createElement('div');
            drop.classList.add('raindrop');
            drop.style.left=`${Math.random()*100}%`;
            drop.style.animationDuration=`${0.5+Math.random()}s`;
            rainContainer.appendChild(drop);
        }
        setTimeout(stopRain,60000);
    }
    function stopRain(){
        rainContainer.style.opacity=0;
        setTimeout(()=>{
            rainContainer.style.display='none';
            document.body.style.background='#87CEEB';
            content.style.color='#000';
            content.classList.remove('rainy');
            sun.style.display='block';
            clouds.forEach(c=>c.style.background='#fff');
            while(rainContainer.firstChild){ rainContainer.removeChild(rainContainer.firstChild);}
        },1000);
    }
    setInterval(startRain,30000);
});
</script>

</body>
</html>
